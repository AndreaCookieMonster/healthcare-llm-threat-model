---
layout: default
title: Threat catalog
permalink: /threats/
---
<link rel="stylesheet" href="{{ '/assets/css/threats.css' | relative_url }}">
<h1>Threat catalog</h1>
<div class="th-toolbar">
  <input id="th-search" class="th-search" type="search" placeholder="Search title, example, impactâ€¦">
  <select id="th-risk" class="th-select">
    <option value="">All risks</option>
    {% assign risks = site.threats | map: 'risk_id' | uniq | sort %}
    {% for r in risks %}
      {% if r %}<option value="{{ r }}">{{ r }}</option>{% endif %}
    {% endfor %}
  </select>
  <span class="th-count"><span id="th-count">0</span> items</span>
</div>
<div id="th-grid" class="th-grid">
  {% assign items = site.threats | sort: 'title' %}
  {% for t in items %}
    <div class="th-item"
         data-risk="{{ t.risk_id | escape }}"
         data-text="{{ t.title | downcase | escape }} {{ t.example | downcase | escape }} {{ t.impact | downcase | escape }} {{ t.tags | join:' ' | downcase | escape }}">
      {% include threat-card.html
         risk_id=t.risk_id title=t.title url=t.url
         example=t.example impact=t.impact
         mitigations=t.mitigations tags=t.tags summary=t.summary %}
    </div>
  {% endfor %}
</div>
<script>
(function(){
  const q = document.getElementById('th-search');
  const r = document.getElementById('th-risk');
  const grid = document.getElementById('th-grid');
  const items = Array.from(grid.querySelectorAll('.th-item'));
  const count = document.getElementById('th-count');
  function apply(){
    const text = (q.value || '').trim().toLowerCase();
    const risk = r.value;
    let n=0;
    items.forEach(el=>{
      const okRisk = !risk || (el.dataset.risk===risk);
      const okText = !text || el.dataset.text.indexOf(text) >= 0;
      el.style.display = (okRisk && okText) ? '' : 'none';
      if (okRisk && okText) n++;
    });
    count.textContent = n;
  }
  q.addEventListener('input', apply);
  r.addEventListener('change', apply);
  apply();
})();
</script>
